<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="æœ¬æ–‡ä»‹ç»ä»LangChainåŸºç¡€åˆ°æ„å»ºç®€å•Agentçš„å®ç°è¿‡ç¨‹ï¼ŒåŒ…æ‹¬LLMè°ƒç”¨ã€Promptæ¨¡æ¿ã€å·¥å…·é›†æˆç­‰å…³é”®æ¦‚å¿µã€‚"><title>Langchainåˆ°ç®€å•Agent</title><link rel=canonical href=https://sutdown.github.io/p/langchain%E5%88%B0%E7%AE%80%E5%8D%95agent/><link rel=stylesheet href=/scss/style.min.e99cacdfab3d9a5b701f58688b2e6aadbc69a6f5d7ee5c79ce234e92e117e59e.css><meta property='og:title' content="Langchainåˆ°ç®€å•Agent"><meta property='og:description' content="æœ¬æ–‡ä»‹ç»ä»LangChainåŸºç¡€åˆ°æ„å»ºç®€å•Agentçš„å®ç°è¿‡ç¨‹ï¼ŒåŒ…æ‹¬LLMè°ƒç”¨ã€Promptæ¨¡æ¿ã€å·¥å…·é›†æˆç­‰å…³é”®æ¦‚å¿µã€‚"><meta property='og:url' content='https://sutdown.github.io/p/langchain%E5%88%B0%E7%AE%80%E5%8D%95agent/'><meta property='og:site_name' content='Sutdown'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2025-10-06T00:00:00+00:00'><meta property='article:modified_time' content='2025-10-06T00:00:00+00:00'><meta property='og:image' content='https://sutdown.github.io/images/d92d9921.jpg'><meta name=twitter:title content="Langchainåˆ°ç®€å•Agent"><meta name=twitter:description content="æœ¬æ–‡ä»‹ç»ä»LangChainåŸºç¡€åˆ°æ„å»ºç®€å•Agentçš„å®ç°è¿‡ç¨‹ï¼ŒåŒ…æ‹¬LLMè°ƒç”¨ã€Promptæ¨¡æ¿ã€å·¥å…·é›†æˆç­‰å…³é”®æ¦‚å¿µã€‚"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://sutdown.github.io/images/d92d9921.jpg'><link rel="shortcut icon" href=/favicon.svg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=https://avatars.githubusercontent.com/Sutdown width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Sutdown</a></h1><h2 class=site-description>ç™½æ—¥ä¾å±±å°½ï¼Œé»„æ²³å…¥æµ·æµã€‚</h2></div></header><ol class=menu-social><li><a href=https://github.com/Sutdown target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.xiaohongshu.com/user/profile/67c68dd4000000000a03f378 target=_blank title=Xiaohongshu rel=me><svg t="1768107575281" class="icon" viewBox="0 0 1024 1024" p-id="8009" width="200" height="200"><path d="M996.152 56.513c-7.986-10.852-17.61-20.885-28.871-28.87C944.143 10.442 916.09.0 885.377.0H138.419c-30.715.0-59.176 10.443-82.314 27.642-10.852 7.986-20.885 17.61-28.87 28.87C10.444 79.448.001 107.703.001 138.623V885.58c0 30.715 10.442 59.176 27.641 81.905 7.986 10.852 17.61 20.885 28.871 28.87 23.138 17.2 51.19 27.643 81.904 27.643h746.959c30.714.0 59.175-10.443 81.904-27.642 10.852-7.986 20.885-17.61 28.87-28.87 17.2-23.139 27.643-51.19 27.643-81.905V138.622c0-30.92-10.852-59.175-27.642-82.11zm-629.633 410.54c16.38-36.241 34.81-71.87 52.213-107.497h59.995c-14.743 29.28-31.124 57.947-41.566 85.794 24.366-1.433 46.48-2.662 72.484-4.095-13.923 27.847-26.209 52.623-38.494 77.398-1.639 3.276-3.277 6.757-4.915 10.033-12.9 25.8-12.9 26.004 15.767 26.62 3.071.0 5.938.41 11.466 1.022-7.985 15.767-15.152 30.1-22.728 44.228-1.229 2.253-4.71 4.915-6.962 4.915-21.09.0-42.385.614-63.475-1.639-15.152-1.638-21.09-13.309-15.152-27.642 7.166-17.814 15.766-35.219 23.752-52.828 2.662-6.143 5.528-12.08 9.42-21.09-11.673.0-20.272.206-28.872.0-24.776-1.023-33.17-12.285-22.933-35.218zM76.171 658.299c-12.695-22.114-24.16-42.59-35.832-63.065.0-2.458 22.933-72.485 17.814-151.726h63.065s2.253 148.45-45.047 214.791zm147.222-7.985c.614 37.061-24.98 37.061-24.98 37.061H162.17l-38.085-50.37h39.928v-277.45h59.994c0 90.915-.204 199.846-.614 290.76zm87.227 4.71c-28.666-25.186-44.227-100.333-43.818-211.925h59.175c-4.504 58.765 14.538 137.187 14.538 137.187s-17.404 38.495-29.895 74.737zm129.817 26.004c-1.638 3.071-6.757 5.938-10.443 6.142-27.847.41-55.9.205-87.842.205 12.081-24.16 22.114-43.818 30.92-61.018h95.621c-10.647 20.885-19.042 38.085-28.256 54.67zm244.481 6.552h-215.2c10.442-20.68 29.075-57.537 29.075-57.537h61.428V441.87h-38.29v-58.766h138.622v57.947h-37.88v189.196h62.245v57.333zm284.615-43.409c0 43.409-42.385 42.18-42.385 42.18h-55.285l-23.138-49.756 59.995.205s.614-45.047.0-60.609c-.41-13.105-7.576-21.5-20.886-21.704-26.618-.615-53.442-.205-82.722-.205v132.274h-59.38V555.1h-59.995v-61.222h58.356v-51.804h-38.7v-57.947h39.315v-24.571h59.994l.41 24.57h47.708s44.024-1.023 44.228 41.77c.205 12.697.41 54.263.41 68.187 50.575-.205 72.075 10.033 72.075 45.25V644.17zm-25.39-200.46H912.2v-30.507c0-11.057 5.528-21.295 14.947-27.233 10.647-6.757 25.39-11.057 39.314 2.252.614.41 1.024 1.024 1.433 1.638 19.247 20.27 4.095 53.852-23.752 53.852z" fill="#cdcdcd" p-id="8010"/><path d="M805.521 493.878h39.723v-52.01h-40.132z" fill="#cdcdcd" p-id="8011"/></svg></a></li><li><a href=https://www.zhihu.com/people/mcgyfw target=_blank title=Zhihu rel=me><svg t="1768107284785" class="icon" viewBox="0 0 1024 1024" p-id="2041" width="200" height="200"><path d="M351.791182 562.469462h192.945407c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262h159.282726s-.86367-67.402109-18.578124-67.402109-279.979646.0-279.979646.0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461s24.62791 5.832845 36.941354.0c12.313443-5.832845 68.050885-25.924439 84.252893-103.69571h86.570681c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262H109.86113c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449H279.868105c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513.0.0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-.055259.185218 167.855986 193.263655s22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-.045025.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z" fill="#777" p-id="2042"/><path d="M584.918753 182.033893v668.840094h70.318532l28.807093 80.512708 121.875768-80.512708h153.600307L959.520453 182.033893h-374.6017zM887.150192 778.934538h-79.837326l-99.578949 65.782216-23.537066-65.782216h-24.855084L659.341766 256.673847h227.807403V778.934538z" fill="#777" p-id="2043"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/travelling/><svg class="icon" viewBox="0 0 1024 1024"><path d="M691.73 162H332.27c-78.239.0-141.892 63.648-141.892 141.892V682.27c0 36.508 29.704 66.216 66.216 66.216h56.212l-46.078 56.757L220.65 862h582.698l-46.078-56.757-46.078-56.757h56.212c36.512.0 66.216-29.709 66.216-66.216V303.892C833.622 225.648 769.969 162 691.73 162zm0 56.757c46.942.0 85.135 38.189 85.135 85.135v113.513H540.378V218.757H691.73zm-359.46.0h151.351v198.649H247.135V303.892c0-46.946 38.194-85.135 85.135-85.135zm304.599 586.486H339.834l46.078-56.757h252.176l46.078 56.757h-47.297zM767.405 691.73h-510.81c-5.127.0-9.459-4.333-9.459-9.459V474.162h529.73V682.27c-.001 5.127-4.334 9.46-9.461 9.46z" fill="#787878"/><path d="M346.459 587.676m-47.297.0a47.297 47.297.0 1094.594.0 47.297 47.297.0 10-94.594.0z" fill="#787878"/><path d="M677.541 587.676m-47.297.0a47.297 47.297.0 1094.594.0 47.297 47.297.0 10-94.594.0z" fill="#787878"/></svg>
<span>Travelling</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#0-aiç›¸å…³åŸºç¡€æ¦‚å¿µ>0 AIç›¸å…³åŸºç¡€æ¦‚å¿µ</a></li><li><a href=#1-åŸºç¡€llmå’ŒèŠå¤©æ¨¡å‹è°ƒç”¨>1 åŸºç¡€LLMå’ŒèŠå¤©æ¨¡å‹è°ƒç”¨</a><ul><li><a href=#chat-apiè°ƒç”¨>Chat APIè°ƒç”¨</a></li><li><a href=#app-key>APP KEY</a></li><li><a href=#prompt-æ¨¡æ¿>Prompt æ¨¡æ¿</a></li></ul></li><li><a href=#2-ç®€å•agent>2 ç®€å•Agent</a><ul><li><a href=#åŸºç¡€æ¦‚å¿µ>åŸºç¡€æ¦‚å¿µ</a></li><li><a href=#æ ¸å¿ƒé€»è¾‘>æ ¸å¿ƒé€»è¾‘</a></li><li><a href=#langchaintools>LangChain.tools</a></li><li><a href=#æ—…æ¸¸åŠ©æ‰‹agent>æ—…æ¸¸åŠ©æ‰‹agent</a></li></ul></li><li><a href=#åè¯>åè¯</a></li><li><a href=#å‚è€ƒæ–‡æ¡£>å‚è€ƒæ–‡æ¡£</a></li></ul></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/langchain%E5%88%B0%E7%AE%80%E5%8D%95agent/><img src=/images/d92d9921.jpg loading=lazy alt="Featured image of post Langchainåˆ°ç®€å•Agent"></a></div><div class=article-details><header class=article-category><a href=/categories/ai/>AI
</a><a href=/categories/langchain/>LangChain
</a><a href=/categories/llm/>LLM</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/langchain%E5%88%B0%E7%AE%80%E5%8D%95agent/>Langchainåˆ°ç®€å•Agent</a></h2><h3 class=article-subtitle>æœ¬æ–‡ä»‹ç»ä»LangChainåŸºç¡€åˆ°æ„å»ºç®€å•Agentçš„å®ç°è¿‡ç¨‹ï¼ŒåŒ…æ‹¬LLMè°ƒç”¨ã€Promptæ¨¡æ¿ã€å·¥å…·é›†æˆç­‰å…³é”®æ¦‚å¿µã€‚</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-10-06T00:00:00Z>Oct 06, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 8 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h2 id=0-aiç›¸å…³åŸºç¡€æ¦‚å¿µ><a href=#0-ai%e7%9b%b8%e5%85%b3%e5%9f%ba%e7%a1%80%e6%a6%82%e5%bf%b5 class=header-anchor></a>0 AIç›¸å…³åŸºç¡€æ¦‚å¿µ</h2><ul><li><strong>LangChain</strong> æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘ç”±å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰é©±åŠ¨çš„åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚</li><li>**ç”Ÿæˆå¼AIï¼š**ä½¿ç”¨å¤§æ¨¡å‹è¿›è¡Œæ”¯æŒï¼Œåœ¨å¤§é‡åŸå§‹æœªæ ‡è®°çš„æ•°æ®åŸºç¡€ä¸Šå¯¹äºæ·±åº¦å­¦ä¹ æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒï¼Œä»è€Œè®©æœºå™¨èƒ½å¤Ÿç†è§£è¯­è¨€ç”šè‡³å›¾åƒï¼Œèƒ½æ ¹æ®éœ€è¦è‡ªåŠ¨ç”Ÿæˆå†…å®¹ã€‚</li><li>**å¤§æ¨¡å‹çš„è®­ç»ƒé˜¶æ®µï¼š**é¢„è®­ç»ƒï¼ˆæå‡æœ¬èº«çš„çŸ¥è¯†é‡ï¼‰ï¼ŒSFTï¼ˆSupervised Fine-Tuningç›‘ç£å¾®è°ƒï¼Œä¸“æ³¨äºé€‰æ‹©æŸä¸€æ–¹é¢ï¼‰ï¼ŒRLFï¼ˆReinforcement Learning with Human FeedbackåŸºäºäººç±»åé¦ˆçš„å¼ºåŒ–å­¦ä¹ ï¼‰</li><li><strong>prompt</strong>ï¼šä½¿ç”¨å¤§æ¨¡å‹æ—¶ï¼Œå‘æ¨¡å‹æä¾›çš„ä¸€äº›æŒ‡ä»¤æˆ–è€…é—®é¢˜ï¼Œè¿™äº›æŒ‡ä»¤ä½œä¸ºæ¨¡å‹è¾“å…¥ï¼Œå¼•å¯¼æ¨¡å‹äº§ç”Ÿå¿…è¦çš„è¾“å‡ºã€‚</li></ul><h2 id=1-åŸºç¡€llmå’ŒèŠå¤©æ¨¡å‹è°ƒç”¨><a href=#1-%e5%9f%ba%e7%a1%80llm%e5%92%8c%e8%81%8a%e5%a4%a9%e6%a8%a1%e5%9e%8b%e8%b0%83%e7%94%a8 class=header-anchor></a>1 åŸºç¡€LLMå’ŒèŠå¤©æ¨¡å‹è°ƒç”¨</h2><h3 id=chat-apiè°ƒç”¨><a href=#chat-api%e8%b0%83%e7%94%a8 class=header-anchor></a>Chat APIè°ƒç”¨</h3><p>LangChain å°†åº•å±‚ API è°ƒç”¨æŠ½è±¡ä¸ºç»Ÿä¸€çš„æ¥å£ï¼ˆå¦‚<code>ChatOpenAI</code>ã€<code>LLM</code>ç±»ï¼‰ï¼Œå±è”½äº†ä¸åŒæ¨¡å‹ API çš„å·®å¼‚ï¼ˆå¦‚é˜¿é‡Œäº‘ã€ç™¾åº¦ã€OpenAI çš„æ¥å£æ ¼å¼ä¸åŒï¼‰ã€‚</p><blockquote><p>å½“å‰æ”¯æŒçš„æ¨¡å‹ï¼š<a class=link href=https://python.langchain.ac.cn/docs/integrations/chat/ target=_blank rel=noopener>èŠå¤©æ¨¡å‹ | ğŸ¦œï¸ğŸ”— LangChain æ¡†æ¶</a></p></blockquote><h3 id=app-key><a href=#app-key class=header-anchor></a>APP KEY</h3><p>ä»¥é€šä¹‰åƒé—®ä¸ºä¾‹ï¼Œapp keyå¯ä»¥ä»<a class=link href=https://www.aliyun.com/product/bailian target=_blank rel=noopener>é˜¿é‡Œäº‘ç™¾ç‚¼å¤§æ¨¡å‹æœåŠ¡å¹³å°</a>ä¸­è·å–ï¼Œå­˜åœ¨ä¸€å®šçš„å…è´¹é¢åº¦ï¼Œapp keyå»ºè®®æ–°å»ºä¸€ä¸ª<code>.env</code>æ–‡ä»¶å­˜å‚¨ï¼ŒåŠ ä¸Š<code>load_dotenv()</code>é¢„å…ˆåŠ è½½å³å¯ã€‚</p><h3 id=prompt-æ¨¡æ¿><a href=#prompt-%e6%a8%a1%e6%9d%bf class=header-anchor></a>Prompt æ¨¡æ¿</h3><p><code>ChatPromptTemplate</code> æ˜¯ LangChain ä¸­ç”¨äºç®¡ç†å¯¹è¯æç¤ºè¯çš„æ ¸å¿ƒå·¥å…·ï¼Œä¸“ä¸ºå¤šè§’è‰²ï¼ˆå¦‚ <code>system</code>ã€<code>user</code>ã€<code>assistant</code>ï¼‰å¯¹è¯åœºæ™¯è®¾è®¡ï¼Œå…¶ä¼˜ç‚¹ä¸»è¦ä½“ç°åœ¨<strong>ç»“æ„åŒ–ã€çµæ´»æ€§ã€å¤ç”¨æ€§</strong>å’Œ<strong>ç”Ÿæ€é›†æˆèƒ½åŠ›</strong>ä¸Šã€‚</p><p>å®ƒçš„æ ¸å¿ƒåœ¨äºå¢åŠ äº†æç¤ºè¯çš„çµæ´»æ€§ï¼Œå°†å…¶ä»â€é™æ€å­—ç¬¦ä¸²â€œå‡çº§æˆäº†â€å¯é…ç½®ï¼Œå¯åŠ¨æ€ç”Ÿæˆï¼Œå¯é›†æˆçš„ç»“æ„åŒ–ç»„ä»¶â€œã€‚åœ¨éœ€è¦å¤„ç†å¤šè§’è‰²åº¦åŒ–ï¼ŒåŠ¨æ€è°ƒæ•´æç¤ºè¯ï¼Œå¤ç”¨æ¨¡æ¿æˆ–è€…é›†æˆlangchainçš„å…¶å®ƒåŠŸèƒ½æ—¶ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡ä»£ç è´¨é‡ã€‚</p><blockquote><p>å®˜æ–¹æ–‡æ¡£ï¼š<a class=link href=https://python.langchain.ac.cn/docs/concepts/prompt_templates/ target=_blank rel=noopener>æç¤ºæ¨¡æ¿ | ğŸ¦œï¸ğŸ”— LangChain æ¡†æ¶</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain_community.chat_models</span> <span class=kn>import</span> <span class=n>ChatTongyi</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dotenv</span> <span class=kn>import</span> <span class=n>load_dotenv</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain_core.prompts</span> <span class=kn>import</span> <span class=n>ChatPromptTemplate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>load_dotenv</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&#34;DASHSCOPE_API_KEY&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;DASHSCOPE_API_KEY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>chat</span> <span class=o>=</span> <span class=n>ChatTongyi</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;qwen3-max&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>prompt_template</span> <span class=o>=</span> <span class=n>ChatPromptTemplate</span><span class=o>.</span><span class=n>from_messages</span><span class=p>([</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;ä½ æ˜¯</span><span class=si>{role}</span><span class=s2>ï¼Œä¸“ä¸šé¢†åŸŸä¸º</span><span class=si>{field}</span><span class=s2>ã€‚å›ç­”éœ€ç¬¦åˆ</span><span class=si>{style}</span><span class=s2>é£æ ¼ï¼Œæ§åˆ¶åœ¨</span><span class=si>{word_limit}</span><span class=s2>å­—å·¦å³ã€‚&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;è¿™ä¸ª</span><span class=si>{concept}</span><span class=s2>çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Œæ‹…ä»»ä»€ä¹ˆæ ·çš„è§’è‰²ï¼Ÿ&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>params1</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;ç§‘æ™®åšä¸»&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;field&#34;</span><span class=p>:</span> <span class=s2>&#34;äººå·¥æ™ºèƒ½&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;style&#34;</span><span class=p>:</span> <span class=s2>&#34;å£è¯­åŒ–ã€é€šä¿—æ˜“æ‡‚&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;word_limit&#34;</span><span class=p>:</span> <span class=s2>&#34;30&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;concept&#34;</span><span class=p>:</span> <span class=s2>&#34;é€šä¹‰åƒé—®&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>params2</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;AIå·¥ç¨‹å¸ˆ&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;field&#34;</span><span class=p>:</span> <span class=s2>&#34;å¤§è¯­è¨€æ¨¡å‹&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;style&#34;</span><span class=p>:</span> <span class=s2>&#34;ä¸“ä¸šã€æŠ€æœ¯åŒ–&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;word_limit&#34;</span><span class=p>:</span> <span class=s2>&#34;50&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;concept&#34;</span><span class=p>:</span> <span class=s2>&#34;é€šä¹‰åƒé—®&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=== åœºæ™¯1ï¼šå‘æ™®é€šç”¨æˆ·è§£é‡Š ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>messages1</span> <span class=o>=</span> <span class=n>prompt_template</span><span class=o>.</span><span class=n>format_messages</span><span class=p>(</span><span class=o>**</span><span class=n>params1</span><span class=p>)</span>  <span class=c1># ç”¨å‚æ•°å¡«å……æ¨¡æ¿</span>
</span></span><span class=line><span class=cl>    <span class=n>response1</span> <span class=o>=</span> <span class=n>chat</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span><span class=n>messages1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>response1</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== åœºæ™¯2ï¼šå‘å¼€å‘è€…è§£é‡Š ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>messages2</span> <span class=o>=</span> <span class=n>prompt_template</span><span class=o>.</span><span class=n>format_messages</span><span class=p>(</span><span class=o>**</span><span class=n>params2</span><span class=p>)</span>  <span class=c1># å¤ç”¨åŒä¸€æ¨¡æ¿ï¼Œä»…æ¢å‚æ•°</span>
</span></span><span class=line><span class=cl>    <span class=n>response2</span> <span class=o>=</span> <span class=n>chat</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span><span class=n>messages2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>response2</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>=== åœºæ™¯1ï¼šå‘æ™®é€šç”¨æˆ·è§£é‡Š ===
</span></span></span><span class=line><span class=cl><span class=s2>é€šä¹‰åƒé—®æ˜¯ä¸ªAIåŠ©æ‰‹ï¼Œèƒ½å›ç­”é—®é¢˜ã€å†™æ•…äº‹ã€ç¼–ç¨‹ï¼Œå¸®ä½ æå®šå„ç§ä»»åŠ¡ï¼
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>=== åœºæ™¯2ï¼šå‘å¼€å‘è€…è§£é‡Š ===
</span></span></span><span class=line><span class=cl><span class=s2>é€šä¹‰åƒé—®æ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼Œç”¨äºç†è§£ä¸ç”Ÿæˆäººç±»è¯­è¨€ï¼Œæ”¯æŒé—®ç­”ã€åˆ›ä½œã€æ¨ç†ç­‰ä»»åŠ¡ï¼Œæ‰®æ¼”æ™ºèƒ½åŠ©æ‰‹è§’è‰²ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=2-ç®€å•agent><a href=#2-%e7%ae%80%e5%8d%95agent class=header-anchor></a>2 ç®€å•Agent</h2><h3 id=åŸºç¡€æ¦‚å¿µ><a href=#%e5%9f%ba%e7%a1%80%e6%a6%82%e5%bf%b5 class=header-anchor></a>åŸºç¡€æ¦‚å¿µ</h3><p><strong>AI agents</strong>ï¼šåŸºäºLLMçš„èƒ½å¤Ÿè‡ªä¸»ç†è§£ï¼Œè‡ªä¸»è§„åˆ’å†³ç­–ï¼Œæ‰§è¡Œå¤æ‚ä»»åŠ¡çš„æ™ºèƒ½ä½“ã€‚</p><p><strong>AI agentsæµç¨‹</strong></p><ul><li>è§„åˆ’ï¼ˆplaningï¼‰ï¼šå°†ä»»åŠ¡åˆ†ä¸ºå­ä»»åŠ¡ï¼Œå¯¹ä»»åŠ¡è¿›è¡Œæ€è€ƒåæ€ &mdash; ç»™ä¸€ä¸ªåˆé€‚çš„prompt</li><li>è®°å¿†ï¼ˆmemoryï¼‰ï¼šè®°ä½æ‰§è¡Œä»»åŠ¡çš„ä¸Šä¸‹æ–‡ï¼Œæœ‰åŠ©äºæ›´å¥½çš„ç†è§£å½“å‰ä»»åŠ¡ &mdash; çŸ­æœŸè®°å¿† é•¿æœŸè®°å¿†</li><li>å·¥å…·ï¼ˆtoolsï¼‰ï¼šä¸ºæ™ºèƒ½ä½“é…å¤‡å·¥å…·AIï¼Œæ¯”å¦‚è®¡ç®—å™¨ï¼Œæœç´¢å·¥å…·ç­‰</li></ul><h3 id=æ ¸å¿ƒé€»è¾‘><a href=#%e6%a0%b8%e5%bf%83%e9%80%bb%e8%be%91 class=header-anchor></a>æ ¸å¿ƒé€»è¾‘</h3><p><code>Agent</code> çš„æ ¸å¿ƒé€»è¾‘éµå¾ª REACT æ¡†æ¶ï¼ˆReasonâ†’Actâ†’Observeâ†’Reactï¼‰ï¼Œè¿™æ˜¯ä¸€ç§å…¸å‹çš„é“¾å¼æµç¨‹ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>ç”¨æˆ·è¾“å…¥ â†’ è®°å¿†ç»„ä»¶ï¼ˆåŠ è½½å†å²å¯¹è¯ï¼‰ â†’ Agentï¼ˆåˆ†ææ˜¯å¦è°ƒç”¨å·¥å…·ï¼‰ â†’ å·¥å…·ï¼ˆæ‰§è¡Œä»»åŠ¡ï¼‰ â†’ Agentï¼ˆå¤„ç†ç»“æœï¼‰ â†’ è®°å¿†ç»„ä»¶ï¼ˆä¿å­˜æ–°å¯¹è¯ï¼‰ â†’ è¾“å‡ºå›ç­”
</span></span></code></pre></td></tr></table></div></div><h3 id=langchaintools><a href=#langchaintools class=header-anchor></a>LangChain.tools</h3><p>LangChain çš„ Tools æ˜¯è¿æ¥å¤§æ¨¡å‹ä¸å¤–éƒ¨åŠŸèƒ½çš„æ ¸å¿ƒç»„ä»¶ã€‚å·¥å…·æ˜¯ä¸€ç§å°è£…å‡½æ•°åŠå…¶æ¨¡å¼çš„æ–¹å¼ï¼Œä»¥ä¾¿å¯ä»¥å°†å…¶ä¼ é€’ç»™èŠå¤©æ¨¡å‹ã€‚ä½¿ç”¨@toolè£…é¥°å™¨åˆ›å»ºå·¥å…·ï¼Œè¯¥è£…é¥°å™¨ç®€åŒ–äº†å·¥å…·åˆ›å»ºè¿‡ç¨‹ï¼Œæ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>è‡ªåŠ¨æ¨æ–­å·¥å…·çš„<strong>åç§°</strong>ã€<strong>æè¿°</strong>å’Œ<strong>é¢„æœŸå‚æ•°</strong>ï¼ŒåŒæ—¶æ”¯æŒè‡ªå®šä¹‰ã€‚</li><li>å®šä¹‰è¿”å›<strong>å·¥ä»¶</strong>ï¼ˆä¾‹å¦‚å›¾åƒã€æ•°æ®æ¡†ç­‰ï¼‰çš„å·¥å…·</li><li>ä½¿ç”¨<strong>æ³¨å…¥çš„å·¥å…·å‚æ•°</strong>ä»æ¨¡å¼ï¼ˆä»è€Œä»æ¨¡å‹ï¼‰ä¸­éšè—è¾“å…¥å‚æ•°ã€‚</li></ul><p><a class=link href=https://python.langchain.ac.cn/docs/concepts/tools/ target=_blank rel=noopener>å·¥å…· | ğŸ¦œï¸ğŸ”— LangChain æ¡†æ¶</a></p><h3 id=æ—…æ¸¸åŠ©æ‰‹agent><a href=#%e6%97%85%e6%b8%b8%e5%8a%a9%e6%89%8bagent class=header-anchor></a>æ—…æ¸¸åŠ©æ‰‹agent</h3><p>è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ªåŸºäº <strong>LangChain</strong> å’Œ <strong>é€šä¹‰åƒé—®ï¼ˆChatTongyiï¼‰</strong> çš„æ™ºèƒ½æ—…è¡ŒåŠ©æ‰‹ï¼Œå…·å¤‡è”ç½‘æœç´¢ã€é¢„ç®—è®¡ç®—å’Œå¤šè½®å¯¹è¯è®°å¿†åŠŸèƒ½ã€‚</p><ul><li>è°·æ­Œæœç´¢å·¥å…·ï¼ˆgoogle_searchï¼‰ï¼šé€šè¿‡ Serper API è°ƒç”¨ Google æœç´¢ï¼Œè·å–å®æ—¶ä¿¡æ¯å¦‚å¤©æ°”ã€æ™¯ç‚¹ã€æ”¿ç­–ç­‰ã€‚<a class=link href=https://serper.dev/logs target=_blank rel=noopener>Serper API key</a>ï¼Œä¹Ÿå¯ä»¥ç”¨å…¶ä½™æœç´¢å·¥å…·ï¼Œé‡‡ç”¨ç›¸åº”çš„api keyå³å¯ã€‚</li><li>é¢„ç®—è®¡ç®—å·¥å…·ï¼ˆcalculate_budgetï¼‰ï¼šè¾“å…¥â€œå¤©æ•°,æ¯æ—¥é¢„ç®—â€æ ¼å¼ï¼Œè‡ªåŠ¨è®¡ç®—æ—…è¡Œæ€»è´¹ç”¨ã€‚</li><li>å¯¹è¯è®°å¿†ï¼ˆConversationSummaryMemoryï¼‰ï¼šä¿ç•™å†å²å¯¹è¯æ‘˜è¦ï¼Œå¸®åŠ©æ¨¡å‹ç†è§£ä¸Šä¸‹æ–‡ï¼ˆå¦‚â€œåˆšæ‰çš„åŸå¸‚â€ï¼‰</li><li>è‡ªå®šä¹‰æç¤ºè¯æ¨¡æ¿ï¼ˆChatPromptTemplateï¼‰ï¼šå®šä¹‰ç³»ç»Ÿè¡Œä¸ºå’Œå·¥å…·ä½¿ç”¨é€»è¾‘ï¼Œè®©æ¨¡å‹å†³å®šä½•æ—¶è°ƒç”¨å·¥å…·ã€‚</li><li>æ™ºèƒ½ä½“ï¼ˆAgentï¼‰åˆå§‹åŒ–ï¼šé€šè¿‡ <code>initialize_agent()</code> å°† LLMã€å·¥å…·å’Œè®°å¿†æ•´åˆä¸ºå…·å¤‡æ¨ç†å’Œå·¥å…·è°ƒç”¨èƒ½åŠ›çš„å¯¹è¯ä½“ã€‚</li><li>äº¤äº’å¾ªç¯ï¼ˆchat_loopï¼‰ï¼šå®ç°å‘½ä»¤è¡Œå¤šè½®èŠå¤©ç•Œé¢ï¼Œæ”¯æŒå®æ—¶è¾“å…¥ä¸é€€å‡ºï¼ˆexit/é€€å‡ºï¼‰ã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dotenv</span> <span class=kn>import</span> <span class=n>load_dotenv</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain_community.chat_models</span> <span class=kn>import</span> <span class=n>ChatTongyi</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.prompts</span> <span class=kn>import</span> <span class=n>ChatPromptTemplate</span><span class=p>,</span> <span class=n>MessagesPlaceholder</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.tools</span> <span class=kn>import</span> <span class=n>tool</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.memory</span> <span class=kn>import</span> <span class=n>ConversationSummaryMemory</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.agents</span> <span class=kn>import</span> <span class=n>initialize_agent</span><span class=p>,</span> <span class=n>AgentType</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>load_dotenv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;tool&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nd>@tool</span><span class=p>(</span><span class=s2>&#34;è°·æ­Œæœç´¢&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>description</span><span class=o>=</span><span class=s2>&#34;ä½¿ç”¨ Google æœç´¢è·å–å®æ—¶ä¿¡æ¯ï¼Œå¦‚â€˜åŒ—äº¬å¤©æ°”â€™ã€â€˜ä¸œäº¬æ™¯ç‚¹æ¨èâ€™ã€â€˜ç­¾è¯æ”¿ç­–â€™ç­‰&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>google_search</span><span class=p>(</span><span class=n>query</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>api_key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;SERPER_API_KEY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>api_key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;æœªè®¾ç½® SERPER_API_KEY ç¯å¢ƒå˜é‡&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;https://google.serper.dev/search&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;X-API-KEY&#34;</span><span class=p>:</span> <span class=n>api_key</span><span class=p>,</span> <span class=s2>&#34;Content-Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application/json&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;q&#34;</span><span class=p>:</span> <span class=n>query</span><span class=p>,</span> <span class=s2>&#34;num&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>res</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;organic&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s2>&#34;æœªæ‰¾åˆ°æœç´¢ç»“æœã€‚&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;title&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;snippet&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>r</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;link&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>)&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;organic&#34;</span><span class=p>][:</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>results</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;æœç´¢å‡ºé”™: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@tool</span><span class=p>(</span><span class=s2>&#34;è®¡ç®—æ—…è¡Œé¢„ç®—&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>description</span><span class=o>=</span><span class=s2>&#34;è®¡ç®—æ—…è¡Œæ€»é¢„ç®—ï¼Œè¾“å…¥æ ¼å¼ä¸ºâ€œå¤©æ•°,æ¯æ—¥é¢„ç®—â€ï¼ˆå¦‚â€œ3,500â€ï¼‰ï¼Œè¿”å›æ€»é¢„ç®—ç»“æœ&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=n>return_direct</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>calculate_budget</span><span class=p>(</span><span class=n>input_str</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;è®¡ç®—æ—…è¡Œæ€»é¢„ç®—ï¼Œè¾“å…¥æ ¼å¼ä¸ºâ€œå¤©æ•°,æ¯æ—¥é¢„ç®—â€ï¼ˆå¦‚â€œ3,500â€ï¼‰&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>days</span><span class=p>,</span> <span class=n>daily_cost</span> <span class=o>=</span> <span class=n>input_str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;,&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>total</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>days</span><span class=p>)</span> <span class=o>*</span> <span class=nb>int</span><span class=p>(</span><span class=n>daily_cost</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;æ€»é¢„ç®—ï¼š</span><span class=si>{</span><span class=n>days</span><span class=si>}</span><span class=s2>å¤©Ã—</span><span class=si>{</span><span class=n>daily_cost</span><span class=si>}</span><span class=s2>å…ƒ/å¤©=</span><span class=si>{</span><span class=n>total</span><span class=si>}</span><span class=s2>å…ƒ&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;è¾“å…¥æ ¼å¼é”™è¯¯ï¼Œè¯·ä½¿ç”¨â€œå¤©æ•°,æ¯æ—¥é¢„ç®—â€ï¼ˆå¦‚â€œ3,500â€ï¼‰&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tools</span> <span class=o>=</span> <span class=p>[</span><span class=n>google_search</span><span class=p>,</span> <span class=n>calculate_budget</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;llm&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>llm</span> <span class=o>=</span> <span class=n>ChatTongyi</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;qwen3-max&#34;</span><span class=p>,</span> <span class=n>api_key</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;DASHSCOPE_API_KEY&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;memory&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># æ‘˜è¦è®°å¿†ï¼ŒèŠ‚çœtoken</span>
</span></span><span class=line><span class=cl><span class=n>memory</span> <span class=o>=</span> <span class=n>ConversationSummaryMemory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=o>=</span><span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>memory_key</span><span class=o>=</span><span class=s2>&#34;chat_history&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>return_messages</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;prompt&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>prompt</span> <span class=o>=</span> <span class=n>ChatPromptTemplate</span><span class=o>.</span><span class=n>from_messages</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;&#34;ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½æ—…è¡ŒåŠ©æ‰‹ï¼Œæ‹¥æœ‰ä»¥ä¸‹èƒ½åŠ›ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>1. å½“ç”¨æˆ·æå‡ºæ¶‰åŠå®æ—¶ä¿¡æ¯ï¼ˆå¦‚å¤©æ°”ã€æ™¯ç‚¹ã€ç­¾è¯ç­‰ï¼‰çš„é—®é¢˜æ—¶ï¼Œè¯·è°ƒç”¨ã€è°·æ­Œæœç´¢ã€‘å·¥å…·ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>2. å½“ç”¨æˆ·è¦æ±‚é¢„ç®—è®¡ç®—æ—¶ï¼Œè°ƒç”¨ã€è®¡ç®—æ—…è¡Œé¢„ç®—ã€‘å·¥å…·ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>3. å…¶å®ƒæƒ…å†µï¼ˆä¾‹å¦‚è¡Œç¨‹å»ºè®®ã€äº¤é€šè¯´æ˜ï¼‰ç›´æ¥å›ç­”ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>4. ä¿æŒä¸Šä¸‹æ–‡ä¸€è‡´æ€§ï¼ˆchat_historyï¼‰ï¼Œæ¯”å¦‚â€œåˆšæ‰çš„åŸå¸‚â€æŒ‡ä¹‹å‰æåˆ°çš„åŸå¸‚ã€‚
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>å·¥ä½œæµç¨‹ï¼š
</span></span></span><span class=line><span class=cl><span class=s2>- å…ˆåˆ†æç”¨æˆ·é—®é¢˜æ˜¯å¦éœ€è¦å·¥å…·ï¼šéœ€è¦åˆ™è°ƒç”¨ï¼Œä¸éœ€è¦åˆ™ç›´æ¥å›ç­”
</span></span></span><span class=line><span class=cl><span class=s2>- è°ƒç”¨å·¥å…·æ—¶ä¸¥æ ¼éµå¾ªå·¥å…·çš„è¾“å…¥æ ¼å¼
</span></span></span><span class=line><span class=cl><span class=s2>- ç»“åˆå†å²å¯¹è¯ï¼ˆchat_historyï¼‰ç†è§£ä¸Šä¸‹æ–‡ï¼ˆå¦‚â€œåˆšæ‰è¯´çš„åŸå¸‚â€æŒ‡ä¹‹å‰æåˆ°çš„åŸå¸‚ï¼‰
</span></span></span><span class=line><span class=cl><span class=s2>- ç”¨ä¸­æ–‡ç®€æ´å›ç­”ï¼Œé¿å…å†—ä½™
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>MessagesPlaceholder</span><span class=p>(</span><span class=n>variable_name</span><span class=o>=</span><span class=s2>&#34;chat_history&#34;</span><span class=p>),</span>  <span class=c1># æ’å…¥å†å²å¯¹è¯</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=si>{input}</span><span class=s2>&#34;</span><span class=p>),</span>                               <span class=c1># å½“å‰ç”¨æˆ·è¾“å…¥</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;ai&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=si>{agent_scratchpad}</span><span class=s2>&#34;</span><span class=p>)</span>                       <span class=c1># Agentæ€è€ƒè¿‡ç¨‹ï¼ˆè‡ªåŠ¨å¡«å……ï¼‰</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;agent&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>agent</span> <span class=o>=</span> <span class=n>initialize_agent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>tools</span><span class=o>=</span><span class=n>tools</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=o>=</span><span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>agent</span><span class=o>=</span><span class=n>AgentType</span><span class=o>.</span><span class=n>CHAT_CONVERSATIONAL_REACT_DESCRIPTION</span><span class=p>,</span>  <span class=c1># å¸¦è®°å¿†çš„èŠå¤©å‹Agent</span>
</span></span><span class=line><span class=cl>    <span class=n>memory</span><span class=o>=</span><span class=n>memory</span><span class=p>,</span>  <span class=c1># ä½¿ç”¨è®°å¿†</span>
</span></span><span class=line><span class=cl>    <span class=c1># verbose=True,  # è¾“å‡ºè¯¦ç»†æ—¥å¿—</span>
</span></span><span class=line><span class=cl>    <span class=n>agent_kwargs</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;prompt&#34;</span><span class=p>:</span> <span class=n>prompt</span><span class=p>,</span>  <span class=c1># ç»‘å®šæç¤ºè¯æ¨¡æ¿</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;system_message&#34;</span><span class=p>:</span> <span class=n>prompt</span><span class=o>.</span><span class=n>messages</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>prompt</span><span class=o>.</span><span class=n>template</span><span class=p>,</span>  <span class=c1># ç³»ç»Ÿæç¤º</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;extra_prompt_messages&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=n>MessagesPlaceholder</span><span class=p>(</span><span class=n>variable_name</span><span class=o>=</span><span class=s2>&#34;chat_history&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=n>handle_parsing_errors</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># å¿½ç•¥è§£æé”™è¯¯</span>
</span></span><span class=line><span class=cl>    <span class=n>return_intermediate_steps</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;å¤šè½®å¯¹è¯&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>chat_loop</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;æ™ºèƒ½æ—…è¡ŒåŠ©æ‰‹&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;æç¤ºï¼šè¾“å…¥ä»»æ„é—®é¢˜ä¸æˆ‘å¯¹è¯ï¼Œä¾‹å¦‚ï¼š&#39;æˆ‘æ‰“ç®—å»ä¸œäº¬ç©ä¸‰å¤©&#39; æˆ– &#39;å¸®æˆ‘æŸ¥ä¸€ä¸‹åŒ—äº¬å¤©æ°”&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;è¾“å…¥ &#39;exit&#39; æˆ– &#39;é€€å‡º&#39; å¯ç»“æŸå¯¹è¯ã€‚</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>user_input</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;ç”¨æˆ·ï¼š&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_input</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;exit&#34;</span><span class=p>,</span> <span class=s2>&#34;quit&#34;</span><span class=p>,</span> <span class=s2>&#34;é€€å‡º&#34;</span><span class=p>,</span> <span class=s2>&#34;bye&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;åŠ©æ‰‹ï¼šå¥½çš„ï¼Œä¸‹æ¬¡å†è§ï¼Œç¥ä½ æ—…é€”æ„‰å¿«ï¼ğŸ‘‹&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>user_input</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>  <span class=c1># å¿½ç•¥ç©ºè¾“å…¥</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>current_time</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&#34;%Yå¹´%mæœˆ</span><span class=si>%d</span><span class=s2>æ—¥ %H:%M&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>user_input</span><span class=si>}</span><span class=se>\n</span><span class=s2>ï¼ˆå½“å‰æ—¶é—´ï¼š</span><span class=si>{</span><span class=n>current_time</span><span class=si>}</span><span class=s2>ï¼‰&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span> <span class=o>=</span> <span class=n>agent</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span><span class=s2>&#34;input&#34;</span><span class=p>:</span> <span class=n>query</span><span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=n>response</span><span class=p>[</span><span class=s2>&#34;output&#34;</span><span class=p>]</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>response</span><span class=p>,</span> <span class=nb>dict</span><span class=p>)</span> <span class=ow>and</span> <span class=s2>&#34;output&#34;</span> <span class=ow>in</span> <span class=n>response</span> <span class=k>else</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;åŠ©æ‰‹ï¼š</span><span class=si>{</span><span class=n>result</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;âŒ å‡ºé”™ï¼š</span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>chat_loop</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=åè¯><a href=#%e5%90%8e%e8%af%9d class=header-anchor></a>åè¯</h2><p>LangChain å®ç°æ™ºèƒ½ä½“çš„æ¨ç†ã€å·¥å…·è°ƒç”¨ä¸è®°å¿†ï¼Œä½†å…¶æ ¸å¿ƒæ¶æ„ä»æ˜¯ã€Œçº¿æ€§é“¾å¼æ‰§è¡Œã€ã€‚åœ¨å¤æ‚å¤šè½®æ¨ç†ã€é•¿ä¸Šä¸‹æ–‡ç®¡ç†å’Œå¹¶å‘åœºæ™¯ä¸‹å­˜åœ¨ä¸€å®šç¼ºé™·ã€‚langchainè¿è¡Œè¿‡ç¨‹ä¸­ä¼šå‡ºç°å®˜æ–¹æç¤ºå½“å‰åŠŸèƒ½<strong>ä»ç„¶å¯ç”¨</strong>ï¼Œä½†<strong>æ¨èè¿ç§»åˆ°æ›´æ–°çš„æ¨¡å—æˆ–æ¡†æ¶</strong>ã€‚</p><p><strong>LangGraph</strong> æ˜¯ LangChain å›¢é˜Ÿæ¨å‡ºçš„ä¸‹ä¸€ä»£æ¡†æ¶ï¼Œå®ƒåŸºäºâ€œæœ‰çŠ¶æ€è®¡ç®—å›¾ï¼ˆStateGraphï¼‰â€æ€æƒ³ï¼Œå°†æ¯ä¸ªæ­¥éª¤å»ºæ¨¡ä¸ºèŠ‚ç‚¹ï¼Œæ”¯æŒæ˜¾å¼çŠ¶æ€ç®¡ç†ã€å¹¶å‘æ‰§è¡Œã€æŒä¹…è®°å¿†ä¸å¯è§†åŒ–è°ƒè¯•ï¼Œæ›´é€‚åˆç”¨äºåˆ›å»ºå®é™…éœ€è¦çš„æ™ºèƒ½ä½“ã€‚</p><p><a class=link href=https://github.langchain.ac.cn/langgraph/concepts/high_level/ target=_blank rel=noopener>ä¸ºä»€ä¹ˆé€‰æ‹© LangGraphï¼Ÿ - LangChain æ¡†æ¶å®˜ç½‘</a></p><h2 id=å‚è€ƒæ–‡æ¡£><a href=#%e5%8f%82%e8%80%83%e6%96%87%e6%a1%a3 class=header-anchor></a>å‚è€ƒæ–‡æ¡£</h2><p><a class=link href=https://python.langchain.ac.cn/docs/introduction/ target=_blank rel=noopener>ç®€ä»‹ | ğŸ¦œï¸ğŸ”— LangChain æ¡†æ¶</a></p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/llm_cookbook-%E9%9D%A2%E5%90%91%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/><div class=article-image><img src=/images/f874fc13.jpg loading=lazy data-key data-hash=/images/f874fc13.jpg></div><div class=article-details><h2 class=article-title>LLM_cookbook é¢å‘å¼€å‘è€…çš„å¤§æ¨¡å‹å…¥é—¨æ•™ç¨‹</h2></div></a></article><article class=has-image><a href=/p/%E5%9F%BA%E4%BA%8Elangchain%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E5%B8%B8%E8%A7%81%E7%94%A8%E6%B3%95/><div class=article-image><img src=/images/7d388d79.jpg loading=lazy data-key data-hash=/images/7d388d79.jpg></div><div class=article-details><h2 class=article-title>åŸºäºlangchainæºç å‰–æå¸¸è§ç”¨æ³•</h2></div></a></article><article class=has-image><a href=/p/code-agent/><div class=article-image><img src=/images/92dbc608.jpg loading=lazy data-key data-hash=/images/92dbc608.jpg></div><div class=article-details><h2 class=article-title>Code Agent</h2></div></a></article><article class=has-image><a href=/p/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%8E%9F%E7%90%86%E4%BB%8Etransformer%E5%88%B0llm/><div class=article-image><img src=/images/9d46bfff.jpg loading=lazy data-key data-hash=/images/9d46bfff.jpg></div><div class=article-details><h2 class=article-title>å¤§æ¨¡å‹åŸç†ï¼šä»transformeråˆ°llm</h2></div></a></article><article class=has-image><a href=/p/mcp%E8%AF%A6%E8%A7%A3%E6%8C%87%E5%8D%97/><div class=article-image><img src=/images/31b7298e.jpg loading=lazy data-key data-hash=/images/31b7298e.jpg></div><div class=article-details><h2 class=article-title>MCPè¯¦è§£æŒ‡å—</h2></div></a></article></div></div></aside><script src=//unpkg.com/@waline/client@v2/dist/waline.js></script><link href=//unpkg.com/@waline/client@v2/dist/waline.css rel=stylesheet><div id=waline class=waline-container></div><style>.waline-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding);--waline-font-size:var(--article-font-size)}.waline-container .wl-count{color:var(--card-text-color-main)}</style><script>Waline.init({avatar:"wavatar",dark:'html[data-scheme="dark"]',el:"#waline",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],lang:"zh-cn",locale:{admin:"Admin",placeholder:null},placeholder:"è¯´ç‚¹ä»€ä¹ˆå§...",requiredMeta:["name","email","url"],serverURL:"https://repo-r1tkfif8s-jias-projects-9d2d822c.vercel.app/",visitor:"true"})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2026 Sutdown</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>